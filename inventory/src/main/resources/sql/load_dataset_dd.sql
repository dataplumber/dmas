/*
* This populates the 'M'andatory dataset element
*/

INSERT into dataset_element (de_id, dataset_id,element_id,obligation_flag, scope)  (select dataset_element_id_seq.nextval,dataset_id, element_id, 'M', 'DATASET' from dataset, element_dd where element_dd.short_name in ('startTime', 'stopTime', 'westernmostLongitude','easternmostLongitude','northernmostLatitude','southernmostLatitude','minAltitude','maxAltitude','minDepth','maxDepth', 'region', 'latitudeResolution', 'longitudeResolution', 'temporalResolution','ellipsoidType','projectionType','projectionDetail','reference', 'regionDetail', 'horizontalResolutionRange', 'altitudeResolution', 'depthResolution', 'temporalResolutionRange'));

COMMIT;

INSERT into dataset_real (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='westernmostLongitude')) ,  west_lon from dataset d LEFT OUTER JOIN dataset_coverage ON d.dataset_id=dataset_coverage.dataset_id;
INSERT into dataset_real (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='easternmostLongitude')) ,  east_lon from dataset d LEFT OUTER JOIN dataset_coverage ON d.dataset_id=dataset_coverage.dataset_id;
INSERT into dataset_real (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='northernmostLatitude')) ,  north_lat from dataset d LEFT OUTER JOIN dataset_coverage ON d.dataset_id=dataset_coverage.dataset_id;
INSERT into dataset_real (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='southernmostLatitude')) ,  south_lat from dataset d LEFT OUTER JOIN dataset_coverage ON d.dataset_id=dataset_coverage.dataset_id;

INSERT into dataset_datetime (dataset_id,de_id,value_long) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='startTime')) ,  start_time_long from dataset d LEFT OUTER JOIN dataset_coverage ON d.dataset_id=dataset_coverage.dataset_id;
INSERT into dataset_datetime (dataset_id,de_id,value_long) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='stopTime')) ,  stop_time_long from dataset d LEFT OUTER JOIN dataset_coverage ON d.dataset_id=dataset_coverage.dataset_id;

INSERT into dataset_real (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='minAltitude')) ,  min_altitude from dataset d LEFT OUTER JOIN dataset_coverage ON d.dataset_id=dataset_coverage.dataset_id;
INSERT into dataset_real (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='minDepth')) ,  min_depth from dataset d LEFT OUTER JOIN dataset_coverage ON d.dataset_id=dataset_coverage.dataset_id;
INSERT into dataset_real (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='maxAltitude')) ,  max_altitude from dataset d LEFT OUTER JOIN dataset_coverage ON d.dataset_id=dataset_coverage.dataset_id;
INSERT into dataset_real (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='maxDepth')) ,  max_depth from dataset d LEFT OUTER JOIN dataset_coverage ON d.dataset_id=dataset_coverage.dataset_id;

INSERT into dataset_character (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='region')) ,region from dataset d;
INSERT into dataset_character (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='latitudeResolution')) ,latitude_resolution from dataset d;
INSERT into dataset_character (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='longitudeResolution')) , longitude_resolution from dataset d;
INSERT into dataset_character (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='temporalResolution')) ,temporal_resolution from dataset d;
INSERT into dataset_character (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='ellipsoidType')) ,ellipsoid_type from dataset d;
INSERT into dataset_character (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='projectionType')) ,projection_type from dataset d;
INSERT into dataset_character (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='projectionDetail')) ,projection_detail from dataset d;
INSERT into dataset_character (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='reference')) , reference from dataset d;

/*End Required DDs */

INSERT into dataset_character (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='regionDetail')) ,region_detail from dataset d;
INSERT into dataset_character (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='horizontalResolutionRange')) ,horizontal_resolution_range from dataset d;
INSERT into dataset_character (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='altitudeResolution')) ,altitude_resolution from dataset d;
INSERT into dataset_character (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='depthResolution')) ,depth_resolution from dataset d;
INSERT into dataset_character (dataset_id,de_id,value) select d.dataset_id,(select de_id from dataset_element, dataset where ROWNUM=1 AND  d.dataset_id=dataset_element.dataset_id AND element_id=(select element_id from element_dd where short_name='temporalResolutionRange')) ,temporal_resolution_range from dataset d;
